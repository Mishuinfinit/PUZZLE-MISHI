<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Puzzle Game</title>
    <style>
        .puzzle-container {
            width: 400px;
            height: 400px;
            position: relative;
            border: 3px solid #333;
            margin: 20px auto;
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 2px;
            background: #f0f0f0;
        }

        .puzzle-piece {
            width: 100%;
            height: 100%;
            cursor: move;
            transition: transform 0.2s;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 24px;
            font-weight: bold;
            user-select: none;
            position: relative;
            overflow: hidden;
            background-image: url('https://th.bing.com/th/id/OIP.dXTtlmtrfQGK1oyKJwolzQHaE8?rs=1&pid=ImgDetMain');
            background-size: 400px 400px;
        }

        .puzzle-piece:nth-child(1) { background-position: 0 0; }
        .puzzle-piece:nth-child(2) { background-position: -133.33px 0; }
        .puzzle-piece:nth-child(3) { background-position: -266.66px 0; }
        .puzzle-piece:nth-child(4) { background-position: 0 -133.33px; }
        .puzzle-piece:nth-child(5) { background-position: -133.33px -133.33px; }
        .puzzle-piece:nth-child(6) { background-position: -266.66px -133.33px; }
        .puzzle-piece:nth-child(7) { background-position: 0 -266.66px; }
        .puzzle-piece:nth-child(8) { background-position: -133.33px -266.66px; }
        .puzzle-piece:nth-child(9) { background-position: -266.66px -266.66px; }

        .puzzle-piece:hover {
            transform: scale(0.95);
        }

        .dragging {
            opacity: 0.8;
            transform: scale(1.05);
        }

        .win-message {
            text-align: center;
            font-size: 24px;
            color: #2ecc71;
            margin-top: 20px;
            display: none;
        }

        button {
            display: block;
            margin: 20px auto;
            padding: 10px 20px;
            font-size: 18px;
            background: #3498db;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
        }

        button:hover {
            background: #2980b9;
        }

        .number-overlay {
            position: absolute;
            background: rgba(255, 255, 255, 0.7);
            padding: 5px;
            border-radius: 50%;
            width: 30px;
            height: 30px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
    </style>
</head>
<body>
    <div class="puzzle-container" id="puzzleContainer">
        <div class="puzzle-piece" draggable="true"><div class="number-overlay">1</div></div>
        <div class="puzzle-piece" draggable="true"><div class="number-overlay">2</div></div>
        <div class="puzzle-piece" draggable="true"><div class="number-overlay">3</div></div>
        <div class="puzzle-piece" draggable="true"><div class="number-overlay">4</div></div>
        <div class="puzzle-piece" draggable="true"><div class="number-overlay">5</div></div>
        <div class="puzzle-piece" draggable="true"><div class="number-overlay">6</div></div>
        <div class="puzzle-piece" draggable="true"><div class="number-overlay">7</div></div>
        <div class="puzzle-piece" draggable="true"><div class="number-overlay">8</div></div>
        <div class="puzzle-piece" draggable="true"><div class="number-overlay">9</div></div>
    </div>
    <div class="win-message" id="winMessage">Congratulations! You solved the puzzle!</div>
    <button onclick="shufflePuzzle()">Shuffle Puzzle</button>
    <script>
        const puzzleContainer = document.getElementById('puzzleContainer');
        const pieces = document.querySelectorAll('.puzzle-piece');
        const winMessage = document.getElementById('winMessage');

        let draggedItem = null;

        pieces.forEach(piece => {
            piece.addEventListener('dragstart', dragStart);
            piece.addEventListener('dragend', dragEnd);
            piece.addEventListener('dragover', dragOver);
            piece.addEventListener('drop', drop);
        });

        function dragStart(e) {
            draggedItem = this;
            setTimeout(() => this.classList.add('dragging'), 0);
        }

        function dragEnd(e) {
            this.classList.remove('dragging');
        }

        function dragOver(e) {
            e.preventDefault();
        }

        function drop(e) {
            e.preventDefault();
            if (this !== draggedItem) {
                let allPieces = [...pieces];
                const draggedIndex = allPieces.indexOf(draggedItem);
                const droppedIndex = allPieces.indexOf(this);

                const draggedBgPos = window.getComputedStyle(draggedItem).backgroundPosition;
                const droppedBgPos = window.getComputedStyle(this).backgroundPosition;

                draggedItem.style.backgroundPosition = droppedBgPos;
                this.style.backgroundPosition = draggedBgPos;

                const draggedNumber = draggedItem.querySelector('.number-overlay').textContent;
                const droppedNumber = this.querySelector('.number-overlay').textContent;

                draggedItem.querySelector('.number-overlay').textContent = droppedNumber;
                this.querySelector('.number-overlay').textContent = draggedNumber;

                checkWin();
            }
        }

        function checkWin() {
            const currentOrder = [...pieces].map(piece => 
                parseInt(piece.querySelector('.number-overlay').textContent)
            );
            const isWin = currentOrder.every((num, index) => num === index + 1);

            if (isWin) {
                winMessage.style.display = 'block';
            } else {
                winMessage.style.display = 'none';
            }
        }

        function shufflePuzzle() {
            const positions = [
                '0 0', '-133.33px 0', '-266.66px 0',
                '0 -133.33px', '-133.33px -133.33px', '-266.66px -133.33px',
                '0 -266.66px', '-133.33px -266.66px', '-266.66px -266.66px'
            ];

            const shuffledPositions = [...positions];
            for (let i = shuffledPositions.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [shuffledPositions[i], shuffledPositions[j]] = [shuffledPositions[j], shuffledPositions[i]];
            }

            pieces.forEach((piece, index) => {
                piece.style.backgroundPosition = shuffledPositions[index];
            });

            winMessage.style.display = 'none';
        }

        shufflePuzzle();
    </script>
</body>
</html>
